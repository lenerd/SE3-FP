#!/usr/bin/env racket
#lang racket

; SE3 FP Übungsblatt 2
; Gruppe 14 (Do. 10-12 Uhr R-031) bei David Mosteller
; Jan-Hendrik Briese, Lennart Braun, Felix Gebauer
; Aufgabe 2.3 Die Eulerzahl e


(require "./2.1_die_fakultaet_einer_zahl.rkt")
(require "./2.2_potenzen_von_rationalzahlen.rkt")

(define (euler-helper n)
        (/ n (factorial (- n 1))))

(define (euler-iter sum n acc)
        (let ((val (euler-helper n)))
             (if (< val acc) sum
                 (euler-iter (+ sum val) (+ n 1) acc))))

; Berechnet e mit der gewünschten Genauigkeit.
(define (euler accuracy)
        (/ (euler-iter 0 1 accuracy) 2))

; Rechnet eine Anzahl an Dezimalstellen in eine entsprechende Rationalzahl um.
(define (decimal-places->accuracy n)
        (power (/ 1 10) n))

; (euler (decimal-places->accuracy 1000))
; 94235694584782917863877998225625489756592733402227261862180688876519416940001
; 09999755583920996300698046248611753833865716471720878122406410369323491909971
; 68020648399422198787038828230507168070574218211195440849015485063918300238537
; 28420647107182705201903615263885025307410580181879529940901487522859256789067
; 05369570308579243127370243180954656172375138131486564226206023682815173144614
; 30210783363153152764144100084494962774921783626381868977987818348410109197164
; 88372053794792166539108101073461499950935019453747791661391904514714056012018
; 82455136344379250271013273359333398392170840458158338078159087972035814575262
; 63783800536520127348373487072715894122757948273421445825293360492471910526299
; 82726716438540807925577120524717122271253066967266272447776652194293949802271
; 55949960396278400585299100068290001295693670741845906388534257008086247704321
; 63315485324864333772727275928307956846058406023422615629367660422201826447746
; 93773188222561217493049737837529607477596090399291861660247486541210785813001
; /3466737466225265318689426292209158799355622530418102031138415019110666003366
; 87350120935017658087742122916225690368481957172371676126033004166945923627033
; 35140343837400844561924474544461327056168076124624738685348270073220203017676
; 44098994185947802327358753233004746170779280780318167228829918886536840902756
; 94328046063652081893679866301226051278367706066830212135229248404116400138727
; 04191934834366383077451235019042761113562618390859600458547606685107116329183
; 99259782473719709554235831692270268013781129425531632967275425260754984672015
; 61446149240171087101367228962532125622915219209983756268567958496811850090756
; 98974850120976962073142895914093577271485873429230352438296939486205959899481
; 42897020943233932810479478520569681738801481799780225498581034302894686277326
; 67849840813230453846060876279210839321864484876184502745377034358086064281164
; 76895872223357136473946072476809253015781376000000000000000000000000000000000
; 00000000000000000000000000000000000000000000000000000000000000000000000000000
; 0

; => e ≈ 2.71828182845904523536028747135266249775724709369995957496696762772407
; 66303535475945713821785251664274274663919320030599218174135966290435729003342
; 95260595630738132328627943490763233829880753195251019011573834187930702154089
; 14993488416750924476146066808226480016847741185374234544243710753907774499206
; 95517027618386062613313845830007520449338265602976067371132007093287091274437
; 47047230696977209310141692836819025515108657463772111252389784425056953696770
; 78544996996794686445490598793163688923009879312773617821542499922957635148220
; 82698951936680331825288693984964651058209392398294887933203625094431173012381
; 97068416140397019837679320683282376464804295311802328782509819455815301756717
; 36133206981125099618188159304169035159888851934580727386673858942287922849989
; 20868058257492796104841984443634632449684875602336248270419786232090021609902
; 35304369941849146314093431738143640546253152096183690888707016768396424378140
; 59271456354906130310720851038375051011574770417189861068739696552126715468895
; 70350353
